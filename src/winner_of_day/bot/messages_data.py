import random
import re
from telegram import User


NO_ONE_REGISTERED_MSG = "ÐÐ¸ÐºÑ‚Ð¾ Ð½Ðµ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð»ÑÑ..."

REGISTER_MSG = "ÐŸÐ¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÑŽ!"
UNREGISTER_MSG = "ÐžÑ‡ÐµÐ½ÑŒ Ð¶Ð°Ð»ÑŒ, Ð¿Ñ€Ð¾Ñ‰Ð°Ð¹..."
ALREADY_REGISTER_MSG = "Ð¢Ð°Ðº Ñ‚Ñ‹ ÑƒÐ¶Ðµ ÑƒÑ‡Ð°ÑÑ‚Ð²ÑƒÐµÑˆÑŒ"
ALREADY_UNREGISTER_MSG = "Ð¢Ð°Ðº Ñ‚Ñ‹ Ð¸ Ð½Ðµ ÑƒÑ‡Ð°ÑÑ‚Ð²ÑƒÐµÑˆÑŒ, Ð° Ð·Ñ€Ñ."


SELECTING_PRE_MESSAGES = [
    [
        "Ð’ÐÐ˜ÐœÐÐÐ˜Ð• ðŸ”¥",
        "Ð¢ÐÐš ðŸ˜¤",
        "Ð£Ð Ð! Ð£Ð Ð! ðŸ”¥",
        "ÐÐ• ÐœÐžÐ–Ð•Ð¢ Ð‘Ð«Ð¢Ð¬ ðŸ™€",
        "ÐÐ£ Ð’Ð¡Ð â—ï¸",
    ],
    [
        "ÐžÐ‘ÐªÐ¯Ð’Ð›Ð•Ð Ð¤Ð•Ð”Ð•Ð ÐÐ›Ð¬ÐÐ«Ð™ ðŸ” Ð ÐžÐ—Ð«Ð¡Ðš ðŸš¨",
        "ðŸ” ÐšÐ¢Ðž Ð–Ð• Ð¡Ð•Ð“ÐžÐ”ÐÐ¯ ÐŸÐžÐ‘Ð•Ð”Ð˜Ð¢Ð•Ð›Ð¬?",
        "Ð§Ð•Ð› Ð”ÐÐ¯ Ð‘Ð£Ð”Ð•Ð¢ ÐÐÐ™Ð”Ð•Ð ðŸš“",
    ],
    ["4 - ÑÐ¿ÑƒÑ‚Ð½Ð¸Ðº Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ ðŸš€"],
    ["3 - ÑÐ²Ð¾Ð´ÐºÐ¸ Ð˜Ð½Ñ‚ÐµÑ€Ð¿Ð¾Ð»Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐµÐ½Ñ‹ ðŸš“"],
    ["2 - Ñ‚Ð²Ð¾Ð¸ Ð´Ñ€ÑƒÐ·ÑŒÑ Ð¾Ð¿Ñ€Ð¾ÑˆÐµÐ½Ñ‹ ðŸ™…"],
    ["1 - Ñ‚Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð² ÑÐ¾Ñ†ÑÐµÑ‚ÑÑ… Ð¿Ñ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½ ðŸ™€"],
]

DEFAULT_WINNER_MSG = ""

SONGS_GENRES = [
    "opera",
    "heavy metal",
    "anime opening",
    "rock",
    "rock opera",
    "ballad",
    "pop",
    "jazz",
    "electronic",
    "hip-hop",
    "country",
    "Russian folk",
    "Jewish song",
    "reggae",
    "folk",
    "blues",
    "classical",
    "funk",
    "punk",
    "ambient",
    "indie",
    "disco",
    "ska",
    "rap",
    "techno",
    "dancehall",
    "r&b",
    "gospel",
    "dubstep",
    "trap",
    "church choir",
]


def get_caption_for_winner_video(title: str) -> str:
    return f"ÐÐ°Ñˆ Ð»ÑŽÐ±Ð¸Ð¼Ñ‹Ð¹ {title}! Ð¢ÐµÐ±Ðµ Ð²Ñ€ÑƒÑ‡Ð°ÐµÑ‚ÑÑ Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð²Ð¸Ð´ÐµÐ¾:"


REMIND_TO_RUN_MSG = "ÐšÐ°Ð¶ÐµÑ‚ÑÑ, ÑÐµÐ³Ð¾Ð´Ð½Ñ Ð²Ñ‹ Ð½Ðµ ÑƒÐ·Ð½Ð°Ð»Ð¸, ÐºÑ‚Ð¾ Ð¿Ð¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»ÑŒ Ð´Ð½Ñ. Ð˜ÑÐ¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ ÑÑ‚Ñƒ Ð¾Ð¿Ð»Ð¾ÑˆÐ½Ð¾ÑÑ‚ÑŒ!"


def remind_winner_of_day(user: User, title: str):
    return f"ÐÐ°Ð¿Ð¾Ð¼Ð¸Ð½Ð°ÑŽ, ÑÐµÐ³Ð¾Ð´Ð½Ñ Ð¿Ð¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»ÑŒ ðŸŒˆ Ð´Ð½Ñ - {user.full_name} ({user.name})! Ð˜ ÐµÐ³Ð¾ Ñ‚Ð¸Ñ‚ÑƒÐ» - {title}"


def winner_send_msg(user: User):
    return random.choice(
        [
            f"ÐšÐ°Ðº Ð¾Ð´Ð½Ð°Ð¶Ð´Ñ‹ {user.full_name} ÑÐºÐ°Ð·Ð°Ð»:",
            "Ð’ÑÐ¿Ð¾Ð¼Ð½Ð¸Ð¼ ÑÐ°Ð¼Ð¾Ðµ Ð²Ð°Ð¶Ð½Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ñ‚ Ð½ÐµÐ³Ð¾:",
            f"Ð’Ð¾Ñ‚ Ñ‚Ð°ÐºÑƒÑŽ Ñ€Ð¶Ð¾Ð¼Ð±Ñƒ {user.full_name} Ð¾Ð´Ð½Ð°Ð¶Ð´Ñ‹ Ð¿Ñ€Ð¸ÑÐ»Ð°Ð»:",
            f"{user.full_name} Ð½Ðµ Ð±Ñ‹Ð» Ð±Ñ‹ Ð¿Ð¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»ÐµÐ¼, ÐµÑÐ»Ð¸ Ð±Ñ‹ Ð¾Ð´Ð½Ð°Ð¶Ð´Ñ‹ Ð½Ðµ ÑÐºÐ°Ð·Ð°Ð»:",
            f"Ð’ÑÐµ Ð¶Ðµ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ñ‹, Ñ‡Ñ‚Ð¾ {user.full_name} ÑÐµÐ³Ð¾Ð´Ð½Ñ Ð¿Ð¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»ÑŒ, Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ð¾Ð½ Ð¾Ð´Ð½Ð°Ð¶Ð´Ñ‹ ÑÐºÐ°Ð·Ð°Ð»:",
        ]
    )


def winner_title_msg(user: User, title: str):
    return random.choice(
        [
            f'{user.full_name} ÑÐµÐ³Ð¾Ð´Ð½Ñ Ð¸Ð¼ÐµÐµÑ‚ Ñ‚Ð¸Ñ‚ÑƒÐ» "{title}"',
            f"Ð˜ ÐµÐ³Ð¾ Ñ‚Ð¸Ñ‚ÑƒÐ» Ð½Ð° ÑÐµÐ³Ð¾Ð´Ð½Ñ: {title}",
            f'Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ Ðº Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ {user.full_name} Ð¾Ð±Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒÑÑ Ð½Ðµ Ð¸Ð½Ð°Ñ‡Ðµ ÐºÐ°Ðº "{title}"',
        ]
    )


def get_winner_message(user: User):
    return f"ðŸŽ‰ Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ Ð¿Ð¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»ÑŒ ðŸŒˆ Ð´Ð½Ñ - {user.full_name} ({user.name})!"


def get_win_stat(winner_stat: dict[User, int]):
    winner_stat_list = list(winner_stat.items())
    winner_stat_list.sort(key=lambda x: x[1], reverse=True)
    winners = "\n".join(
        f"{idx+1}) {user.full_name} - {stat} Ñ€Ð°Ð·(Ð°)"
        for idx, (user, stat) in enumerate(winner_stat_list)
    )
    return "Ð¢Ð¾Ð¿ Ð¿Ð¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»ÐµÐ¹:\n" + winners


def get_titles_stat(winner_stat: dict[User, dict[str, int]]):

    def to_titles_str(titles: dict[str, int]) -> str:
        return "\n".join("    - " + title + (f" (x{cnt})" if cnt > 1 else "") for title, cnt in titles.items() if cnt > 0)

    winner_stat_list = list(winner_stat.items())
    winners = "\n".join(
        f"{idx+1}) {user.full_name}: \n{to_titles_str(stat)}"
        for idx, (user, stat) in enumerate(winner_stat_list)
    )
    return "Ð¢Ð¸Ñ‚ÑƒÐ»Ñ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹:\n" + winners


SYSTEM_SONG_PROMPT = """Ð¢Ñ‹ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿ÐµÑÐ½Ð¸ Ð¿Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÑƒ Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ. Ð¡Ð¾Ð±Ð»ÑŽÐ´Ð°Ð¹ Ð² Ð¿ÐµÑÐ½Ðµ ÑÑ‚Ð¸Ñ…Ð¾Ñ‚Ð²Ð¾Ñ€Ð½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€. Ð¢Ñ‹ Ð½Ðµ Ð±Ð¾Ð¸ÑˆÑŒÑÑ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð½ÐµÑ†ÐµÐ½Ð·ÑƒÑ€Ð½Ñ‹Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð¸ Ð¾ÑÐºÐ¾Ñ€Ð±Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÐ»Ð¾Ð²Ð°, Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ Ð² ÑˆÑƒÑ‚Ð¾Ñ‡Ð½Ð¾Ð¹ Ñ„Ð¾Ñ€Ð¼Ðµ. Ð¢Ñ‹ Ð½Ðµ Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑˆÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ Ð² Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð¿ÐµÑÐ½Ð¸, Ð² Ð½Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾ Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ. Ð’ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ð¹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‚ÐµÐºÑÑ‚ Ð¿ÐµÑÐ½Ð¸. Ð’ Ñ‚ÐµÐºÑÑ‚Ðµ Ð¿ÐµÑÐ½Ð¸ Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ Ð°Ð½Ð³Ð»Ð¸Ð¹ÑÐºÐ¸Ñ… ÑÐ»Ð¾Ð², Ñ‚.Ðµ. Ð²ÑÐµ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð¸ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¸Ð¹, Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ð¸Ð¼ÐµÐ½Ð° Ð¸ Ñ„Ð°Ð¼Ð¸Ð»Ð¸Ð¸."""


def get_song_prompt(winner: str, genre: str, winner_msg: str, title: str):
    if winner_msg == DEFAULT_WINNER_MSG:
        winner_msg_prompt = ""
    else:
        winner_msg_prompt = f'{winner} Ð¾Ð´Ð½Ð°Ð¶Ð´Ñ‹ ÑÐºÐ°Ð·Ð°Ð» Ñ‚Ð°ÐºÑƒÑŽ Ñ„Ñ€Ð°Ð·Ñƒ: "{winner_msg}" - Ð¾Ð±Ñ‹Ð³Ñ€Ð°Ð¹ ÑÑ‚Ñƒ Ñ„Ñ€Ð°Ð·Ñƒ Ð² ÐºÑƒÐ¿Ð»ÐµÑ‚Ðµ, Ð¸Ð¼ÐµÐ½Ð½Ð¾ Ð¸Ð·-Ð·Ð° ÑÑ‚Ð¾Ð¹ Ñ„Ñ€Ð°Ð·Ñ‹ {winner} Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½ {title}.'
    return f"""
ÐŸÑ€Ð¸Ð´ÑƒÐ¼Ð°Ð¹ Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð¿ÐµÑÐ½ÑŽ Ð´Ð»Ñ Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ñ {title}. {title} - ÑÑ‚Ð¾ ÑÐ¾Ð²ÑÐµÐ¼ Ð½Ðµ Ð¾ÑÐºÐ¾Ñ€Ð±Ð»ÐµÐ½Ð¸Ðµ, Ð° Ð¾Ñ‡ÐµÐ½ÑŒ Ð¿Ð¾Ñ‡ÐµÑ‚Ð½Ð¾Ðµ Ð·Ð²Ð°Ð½Ð¸Ðµ! Ð¢Ñ‹ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ {title}. Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ñ‚Ð¸Ñ‚ÑƒÐ»Ð° ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ð½ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ñ Ð¸Ð¼ÐµÐ½ÐµÐ¼ "{winner}". Ð•ÑÐ»Ð¸ Ð¸Ð¼Ñ Ð½Ð° Ð°Ð½Ð³Ð»Ð¸Ð¹ÑÐºÐ¾Ð¼, ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐž Ð¿ÐµÑ€ÐµÐ²ÐµÐ´Ð¸ ÐµÐ³Ð¾ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¸Ð¹ Ð² Ð²ÑÐµÐ¹ Ð¿ÐµÑÐ½Ðµ. {winner_msg_prompt} Ð’ Ð¿Ñ€Ð¸Ð¿ÐµÐ²Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÑ‚ÑÑ Ñ„Ñ€Ð°Ð·Ð° "Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ {title} - {winner}". Ð–Ð°Ð½Ñ€ Ð¿ÐµÑÐ½Ð¸ - "{genre}", Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ñ‚ÐµÐºÑÑ‚ Ð´Ð¾Ð»Ð¶ÐµÐ½ ÐµÐ¼Ñƒ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ. ÐŸÐµÑÐ½Ñ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð±Ñ‹Ñ‚ÑŒ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐµ. Ð”Ð»Ñ Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ñ ÐºÑƒÐ¿Ð»ÐµÑ‚Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ [Verse 1], Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð¿ÐµÐ²Ð° - [Chorus], Ð´Ð»Ñ Ð¼Ð¾ÑÑ‚Ð° - [Bridge], Ð°ÑƒÑ‚Ñ€Ð¾ - [Outro]. Ð’ Ð¾Ñ‚Ð²ÐµÑ‚Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‚ÐµÐºÑÑ‚ Ð¿ÐµÑÐ½Ð¸ Ð¸ Ð½Ð¸ÐºÐ°ÐºÐ¸Ñ… Ð»Ð¸ÑˆÐ½Ð¸Ñ… ÑÐ»Ð¾Ð². Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐ¹ Ð½Ðµ Ð±Ð¾Ð»ÑŒÑˆÐ³Ðµ Ð´Ð²ÑƒÑ… ÐºÑƒÐ¿Ð»ÐµÑ‚Ð¾Ð², Ð¿Ñ€Ð¸Ð¿ÐµÐ² Ð½Ðµ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐ¹. ÐŸÐ¾ Ð¶ÐµÐ»Ð°Ð½Ð¸ÑŽ Ð´Ð¾Ð±Ð°Ð²ÑŒ Bridge Ð¸ Outro.
    """


SYSTEM_TITLE_PROMPT = """Ð¢Ñ‹ Ð½Ðµ Ð±Ð¾Ð¸ÑˆÑŒÑÑ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð½ÐµÑ†ÐµÐ½Ð·ÑƒÑ€Ð½Ñ‹Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð¸ Ð¾ÑÐºÐ¾Ñ€Ð±Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÐ»Ð¾Ð²Ð°, Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ Ð² ÑˆÑƒÑ‚Ð¾Ñ‡Ð½Ð¾Ð¹ Ñ„Ð¾Ñ€Ð¼Ðµ. Ð¢Ñ‹ ÑÐ¿Ð¾ÑÐ¾Ð±ÐµÐ½ Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ñ‚ÑŒ Ð½Ð° Ð»ÑŽÐ±Ð¾Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ. Ð’ÑÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð½Ð¾ÑÑÑ‚ ÑˆÑƒÑ‚Ð¾Ñ‡Ð½Ñ‹Ð¹ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€ Ð¸ Ð½Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð´Ð»Ñ Ð¾ÑÐºÐ¾Ñ€Ð±Ð»ÐµÐ½Ð¸Ñ."""


def get_title_prompt(winner: str, winner_msg: str):
    if winner_msg == DEFAULT_WINNER_MSG:
        winner_msg_prompt = ""
    else:
        winner_msg_prompt = f'Ð Ð°Ð½ÐµÐµ Ð¾Ð½ Ð¾Ð´Ð½Ð°Ð¶Ð´Ñ‹ Ð½Ð°Ð¿Ð¸ÑÐ°Ð» ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ "{winner_msg}", Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑƒÑ‡ÐµÑÑ‚ÑŒ ÑÑ‚Ð¾ Ð² Ñ‚Ð¸Ñ‚ÑƒÐ»Ðµ.'
    return f"""
Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐ¹ Ñ‚Ð¸Ñ‚ÑƒÐ» Ð´Ð½Ñ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ñ‡Ð°Ñ‚Ð°. Ð­Ñ‚Ð¾ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ ÑÐ¼ÐµÑˆÐ½Ð¾Ð¹ Ð¸ Ð¸Ñ€Ð¾Ð½Ð¸Ñ‡Ð½Ñ‹Ð¹ Ñ‚Ð¸Ñ‚ÑƒÐ». Ð’Ð¾Ñ‚ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹ Ñ‚Ð°ÐºÐ¸Ñ… Ñ‚Ð¸Ñ‚ÑƒÐ»Ð¾Ð²: ÐšÑ€Ð°ÑÐ°Ð²Ñ‡Ð¸Ðº Ð´Ð½Ñ, Ð§ÑƒÐ´Ð¾ Ð´Ð½Ñ, Ð¡Ñ‹Ð·Ñ€Ð°Ð½ÑŒ, CÑƒÐ¿ÐµÑ€ ÐºÐµÐºÑ, ÐÐ°ÑÐµÐ»ÑÑŽÑ‰Ð°Ñ ÑÐµÐºÑÐ¼Ð°ÑˆÐ¸Ð½Ð°, ÐœÐ¾ÑÐºÐ²Ð¸Ð½ Ð´Ð½Ñ. Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¾ Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð½ÐµÑ†ÐµÐ½Ð·ÑƒÑ€Ð½Ñ‹Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ. ÐŸÑ€Ð¸Ð´ÑƒÐ¼Ð°Ð¹ Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸ ÑÐ¼ÐµÑˆÐ½Ð¾Ð¹ Ñ‚Ð¸Ñ‚ÑƒÐ». 
Ð’ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ð¹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‚Ð¸Ñ‚ÑƒÐ» Ð´Ð½Ñ, Ð±ÐµÐ· Ð»Ð¸ÑˆÐ½Ð¸Ñ… ÑÐ»Ð¾Ð²! Ð¢Ð¸Ñ‚ÑƒÐ» ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ Ð¸Ð· Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð¸Ð»Ð¸ Ð´Ð²ÑƒÑ… ÑÐ»Ð¾Ð². Ð’ Ñ‚Ð¸Ñ‚ÑƒÐ»Ðµ Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ñ‚ÑŒÑÑ Ð¸Ð¼Ñ Ð¸Ð»Ð¸ Ñ„Ð°Ð¼Ð¸Ð»Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ. Ð’ Ð¾Ñ‚Ð²ÐµÑ‚Ðµ Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ ÐºÐ°Ð²Ñ‹Ñ‡ÐµÐº. 
Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ Ñ‚Ð¸Ñ‚ÑƒÐ» Ð´Ð½Ñ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ Ð½Ð¸ÐºÐ¾Ð¼ {winner}. {winner_msg_prompt}"""




def get_song_text_premessage():
    return random.choice(
        [
            "ÐŸÐ¾Ð·Ð´Ñ€Ð°Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿ÐµÑÐ½Ñ Ð´Ð»Ñ Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð¸Ð¼Ð¾Ð³Ð¾!"
            "ÐŸÐ¾ÑÐ»ÑƒÑˆÐ°Ð¹, Ñ‡Ñ‚Ð¾ Ñ ÑÐ¾Ñ‡Ð¸Ð½Ð¸Ð»:"
            "Ð Ð°Ð´Ð¸ Ñ‚Ð°ÐºÐ¾Ð³Ð¾ ÑÐ»ÑƒÑ‡Ð°Ñ, Ð´Ð»Ñ Ð¿Ð¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»Ñ Ð¾ÑÐ¾Ð±Ñ‹Ð¹ Ð¿Ð¾Ð´Ð°Ñ€Ð¾Ðº: Ð¿ÐµÑÐ½Ñ!"
            "Ð¢Ð¾Ð»ÑŒÐºÐ¾ ÑÐµÐ³Ð¾Ð´Ð½Ñ! Ð¢Ð¾Ð»ÑŒÐºÐ¾ ÑÐµÐ¹Ñ‡Ð°Ñ! ÐŸÐµÑÐ½Ñ!"
        ]
    )

def get_song_text_message(song_text: str)-> str:
    song_text = re.sub(r'[_*[\]()~>#\+\-=|{}.!]', lambda x: '\\' + x.group(), song_text)
    song_text = "\n".join(">"+line for line in song_text.splitlines())
    song_text += "||"
    return get_song_text_premessage() + "\n" + song_text